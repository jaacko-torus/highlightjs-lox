{"version":3,"sources":["lox.ts","lox.js"],"names":["console","log","hljs","regex","IDENT_RE","LANGUAGE_KEYWORDS","LITERALS","BUILT_IN_VARIABLES","KEYWORDS","$pattern","keyword","literal","NUMBER","scope","variants","begin","relevance","PARAMS_CONTAINS","C_LINE_COMMENT_MODE","end","keywords","contains","PARAMS","excludeBegin","excludeEnd","CLASS_OR_EXTENDS","match","FUNCTION_DEFINITION","label","illegal","UPPER_CASE_CONSTANT","noneOf","list","concat","join","FUNCTION_CALL","lookahead","PROPERTY_ACCESS","lox","name","aliases","QUOTE_STRING_MODE","RE_STARTERS_RE","REGEXP_MODE","beginKeywords","UNDERSCORE_IDENT_RE","returnBegin","inherit","TITLE_MODE"],"mappings":"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","file":"lox.js","sourcesContent":["/**\n * @name Lox\n * @param {LanguageFn} hljs\n * @website http://craftinginterpreters.com/\n * @license MIT\n */\n\nimport type { HLJSRegex } from \"../types\";\nimport type { HLJSApi, Language, LanguageFn, Mode } from \"highlight.js\";\nimport hljs from \"highlight.js\";\n\nconsole.log(hljs)\n\nconst regex = (hljs as HLJSApi & HLJSRegex).regex\n\nconst IDENT_RE = \"[A-Za-z][0-9A-Za-z]*\"\n\nconst LANGUAGE_KEYWORDS = [\n\t\"class\",\n\t\"else\",\n\t\"for\",\n\t\"function\",\n\t\"if\",\n\t\"print\",\n\t\"return\",\n\t\"var\",\n\t\"while\",\n]\n\nconst LITERALS = [\n\t\"false\",\n\t\"nil\",\n\t\"true\",\n]\n\nconst BUILT_IN_VARIABLES = [\n\t\"super\",\n\t\"this\",\n]\n\nconst KEYWORDS = {\n\t$pattern: IDENT_RE,\n\tkeyword: LANGUAGE_KEYWORDS,\n\tliteral: LITERALS,\n\t\"variable.language\": BUILT_IN_VARIABLES\n};\n\nconst NUMBER: Mode = {\n\tscope: \"number\",\n\tvariants: [\n\t\t{ begin: \"[\\\\d]+\" },\n\t\t{ begin: \"\\\\d+(\\.\\\\d+)?\" },\n\t],\n\trelevance: 0\n};\n\nconst PARAMS_CONTAINS = [\n\thljs.C_LINE_COMMENT_MODE,\n\t// eat recursive parens in sub expressions\n\t{\n\t\tbegin: /\\(/,\n\t\tend: /\\)/,\n\t\tkeywords: KEYWORDS,\n\t\tcontains: [\"self\", hljs.C_LINE_COMMENT_MODE]\n\t} as Mode\n];\n\nconst PARAMS: Mode = {\n\tscope: \"params\",\n\tbegin: /\\(/,\n\tend: /\\)/,\n\texcludeBegin: true,\n\texcludeEnd: true,\n\tkeywords: KEYWORDS,\n\tcontains: PARAMS_CONTAINS\n};\n\nconst CLASS_OR_EXTENDS: Mode = {\n\tvariants: [\n\t\t// class Car < Vehicle\n\t\t{\n\t\t\tmatch: [\n\t\t\t\t/class/,\n\t\t\t\t/\\s+/,\n\t\t\t\tIDENT_RE,\n\t\t\t\t/\\s+/,\n\t\t\t\t/</,\n\t\t\t\t/\\s+/,\n\t\t\t],\n\t\t\tscope: {\n\t\t\t\t1: \"keyword\",\n\t\t\t\t3: \"title.class\",\n\t\t\t\t5: \"keyword\",\n\t\t\t\t7: \"title.class.inherited\"\n\t\t\t}\n\t\t},\n\t\t// class Car\n\t\t{\n\t\t\tmatch: [\n\t\t\t\t/class/,\n\t\t\t\t/\\s+/,\n\t\t\t\tIDENT_RE\n\t\t\t],\n\t\t\tscope: {\n\t\t\t\t1: \"keyword\",\n\t\t\t\t3: \"title.class\"\n\t\t\t}\n\t\t},\n\t]\n};\n\nconst FUNCTION_DEFINITION: Mode = {\n\tvariants: [\n\t\t{\n\t\t\tmatch: [\n\t\t\t\t/function/,\n\t\t\t\t/\\s+/,\n\t\t\t\tIDENT_RE,\n\t\t\t\t/(?=\\s*\\()/\n\t\t\t]\n\t\t},\n\t],\n\tscope: {\n\t\t1: \"keyword\",\n\t\t3: \"title.function\"\n\t},\n\tlabel: \"func.def\",\n\tcontains: [PARAMS],\n\tillegal: /%/\n};\n\nconst UPPER_CASE_CONSTANT: Mode = {\n\trelevance: 0,\n\tmatch: /\\b[A-Z][A-Z0-9]+\\b/,\n\tscope: \"variable.constant\"\n};\n\nfunction noneOf(list: string[]) {\n\treturn regex.concat(\"(?!\", list.join(\"|\"), \")\");\n}\n\nconst FUNCTION_CALL: Mode = {\n\tmatch: regex.concat(\n\t\t/\\b/,\n\t\tnoneOf([\"super\"]),\n\t\tIDENT_RE, regex.lookahead(/\\(/)),\n\tscope: \"title.function\",\n\trelevance: 0\n};\n\nconst PROPERTY_ACCESS: Mode = {\n\tbegin: regex.concat(/\\./, regex.lookahead(\n\t\tregex.concat(IDENT_RE, /(?![0-9A-Za-z(])/)\n\t)),\n\tend: IDENT_RE,\n\texcludeBegin: true,\n\tscope: \"property\",\n\trelevance: 0\n};\n\n// HLJSApi\n\n/**\n * @name Lox\n * @param {HLJSApi} hljs\n * @website http://craftinginterpreters.com/\n */\nconst lox: LanguageFn = (hljs: HLJSApi) => {\n\treturn {\n\t\tname: \"Lox\",\n\t\taliases: [\"lox\"],\n\t\tkeywords: KEYWORDS,\n\t\tillegal: /#(?![$_A-z])/,\n\t\tcontains: [\n\t\t\thljs.QUOTE_STRING_MODE,\n\t\t\thljs.C_LINE_COMMENT_MODE,\n\t\t\tNUMBER,\n\t\t\t{ // \"value\" container\n\t\t\t\tbegin: \"(\" + hljs.RE_STARTERS_RE + \"|\\\\b(return)\\\\b)\\\\s*\",\n\t\t\t\tkeywords: \"return\",\n\t\t\t\trelevance: 0,\n\t\t\t\tcontains: [\n\t\t\t\t\thljs.C_LINE_COMMENT_MODE,\n\t\t\t\t\thljs.REGEXP_MODE,\n\t\t\t\t\t{ // could be a comma delimited list of params to a function call\n\t\t\t\t\t\tbegin: /,/,\n\t\t\t\t\t\trelevance: 0\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tmatch: /\\s+/,\n\t\t\t\t\t\trelevance: 0\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tFUNCTION_DEFINITION,\n\t\t\t{\n\t\t\t\t// prevent this from getting swallowed up by function since they appear \"function like\"\n\t\t\t\tbeginKeywords: \"while if for\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t// we have to count the parens to make sure we actually have the correct\n\t\t\t\t// bounding ( ).  There could be any number of sub-expressions inside\n\t\t\t\t// also surrounded by parens.\n\t\t\t\tbegin: \"\\\\b(?!function)\" + hljs.UNDERSCORE_IDENT_RE +\n\t\t\t\t\t\"\\\\(\" + // first parens\n\t\t\t\t\t\"[^()]*(\\\\(\" +\n\t\t\t\t\t\"[^()]*(\\\\(\" +\n\t\t\t\t\t\"[^()]*\" +\n\t\t\t\t\t\"\\\\)[^()]*)*\" +\n\t\t\t\t\t\"\\\\)[^()]*)*\" +\n\t\t\t\t\t\"\\\\)\\\\s*\\\\{\", // end parens\n\t\t\t\treturnBegin: true,\n\t\t\t\tlabel: \"func.def\",\n\t\t\t\tcontains: [\n\t\t\t\t\tPARAMS,\n\t\t\t\t\thljs.inherit(hljs.TITLE_MODE, { begin: IDENT_RE, scope: \"title.function\" })\n\t\t\t\t]\n\t\t\t},\n\t\t\tPROPERTY_ACCESS,\n\t\t\t{\n\t\t\t\tmatch: [/\\binit(?=\\s*\\()/],\n\t\t\t\tscope: { 1: \"title.function\" },\n\t\t\t\tcontains: [PARAMS]\n\t\t\t},\n\t\t\tFUNCTION_CALL,\n\t\t\tUPPER_CASE_CONSTANT,\n\t\t\tCLASS_OR_EXTENDS,\n\t\t\t{\n\t\t\t\tmatch: /\\$[(.]/ // relevance booster for a pattern common to JS libs: `$(something)` and `$.something`\n\t\t\t}\n\t\t]\n\t} as Language;\n}\n\nexport default lox;","/**\n * @name Lox\n * @param {LanguageFn} hljs\n * @website http://craftinginterpreters.com/\n * @license MIT\n */\nimport hljs from \"highlight.js\";\nconsole.log(hljs);\nconst regex = hljs.regex;\nconst IDENT_RE = \"[A-Za-z][0-9A-Za-z]*\";\nconst LANGUAGE_KEYWORDS = [\n    \"class\",\n    \"else\",\n    \"for\",\n    \"function\",\n    \"if\",\n    \"print\",\n    \"return\",\n    \"var\",\n    \"while\",\n];\nconst LITERALS = [\n    \"false\",\n    \"nil\",\n    \"true\",\n];\nconst BUILT_IN_VARIABLES = [\n    \"super\",\n    \"this\",\n];\nconst KEYWORDS = {\n    $pattern: IDENT_RE,\n    keyword: LANGUAGE_KEYWORDS,\n    literal: LITERALS,\n    \"variable.language\": BUILT_IN_VARIABLES\n};\nconst NUMBER = {\n    scope: \"number\",\n    variants: [\n        { begin: \"[\\\\d]+\" },\n        { begin: \"\\\\d+(\\.\\\\d+)?\" },\n    ],\n    relevance: 0\n};\nconst PARAMS_CONTAINS = [\n    hljs.C_LINE_COMMENT_MODE,\n    // eat recursive parens in sub expressions\n    {\n        begin: /\\(/,\n        end: /\\)/,\n        keywords: KEYWORDS,\n        contains: [\"self\", hljs.C_LINE_COMMENT_MODE]\n    }\n];\nconst PARAMS = {\n    scope: \"params\",\n    begin: /\\(/,\n    end: /\\)/,\n    excludeBegin: true,\n    excludeEnd: true,\n    keywords: KEYWORDS,\n    contains: PARAMS_CONTAINS\n};\nconst CLASS_OR_EXTENDS = {\n    variants: [\n        // class Car < Vehicle\n        {\n            match: [\n                /class/,\n                /\\s+/,\n                IDENT_RE,\n                /\\s+/,\n                /</,\n                /\\s+/,\n            ],\n            scope: {\n                1: \"keyword\",\n                3: \"title.class\",\n                5: \"keyword\",\n                7: \"title.class.inherited\"\n            }\n        },\n        // class Car\n        {\n            match: [\n                /class/,\n                /\\s+/,\n                IDENT_RE\n            ],\n            scope: {\n                1: \"keyword\",\n                3: \"title.class\"\n            }\n        },\n    ]\n};\nconst FUNCTION_DEFINITION = {\n    variants: [\n        {\n            match: [\n                /function/,\n                /\\s+/,\n                IDENT_RE,\n                /(?=\\s*\\()/\n            ]\n        },\n    ],\n    scope: {\n        1: \"keyword\",\n        3: \"title.function\"\n    },\n    label: \"func.def\",\n    contains: [PARAMS],\n    illegal: /%/\n};\nconst UPPER_CASE_CONSTANT = {\n    relevance: 0,\n    match: /\\b[A-Z][A-Z0-9]+\\b/,\n    scope: \"variable.constant\"\n};\nfunction noneOf(list) {\n    return regex.concat(\"(?!\", list.join(\"|\"), \")\");\n}\nconst FUNCTION_CALL = {\n    match: regex.concat(/\\b/, noneOf([\"super\"]), IDENT_RE, regex.lookahead(/\\(/)),\n    scope: \"title.function\",\n    relevance: 0\n};\nconst PROPERTY_ACCESS = {\n    begin: regex.concat(/\\./, regex.lookahead(regex.concat(IDENT_RE, /(?![0-9A-Za-z(])/))),\n    end: IDENT_RE,\n    excludeBegin: true,\n    scope: \"property\",\n    relevance: 0\n};\n// HLJSApi\n/**\n * @name Lox\n * @param {HLJSApi} hljs\n * @website http://craftinginterpreters.com/\n */\nconst lox = (hljs) => {\n    return {\n        name: \"Lox\",\n        aliases: [\"lox\"],\n        keywords: KEYWORDS,\n        illegal: /#(?![$_A-z])/,\n        contains: [\n            hljs.QUOTE_STRING_MODE,\n            hljs.C_LINE_COMMENT_MODE,\n            NUMBER,\n            {\n                begin: \"(\" + hljs.RE_STARTERS_RE + \"|\\\\b(return)\\\\b)\\\\s*\",\n                keywords: \"return\",\n                relevance: 0,\n                contains: [\n                    hljs.C_LINE_COMMENT_MODE,\n                    hljs.REGEXP_MODE,\n                    {\n                        begin: /,/,\n                        relevance: 0\n                    },\n                    {\n                        match: /\\s+/,\n                        relevance: 0\n                    },\n                ],\n            },\n            FUNCTION_DEFINITION,\n            {\n                // prevent this from getting swallowed up by function since they appear \"function like\"\n                beginKeywords: \"while if for\"\n            },\n            {\n                // we have to count the parens to make sure we actually have the correct\n                // bounding ( ).  There could be any number of sub-expressions inside\n                // also surrounded by parens.\n                begin: \"\\\\b(?!function)\" + hljs.UNDERSCORE_IDENT_RE +\n                    \"\\\\(\" + // first parens\n                    \"[^()]*(\\\\(\" +\n                    \"[^()]*(\\\\(\" +\n                    \"[^()]*\" +\n                    \"\\\\)[^()]*)*\" +\n                    \"\\\\)[^()]*)*\" +\n                    \"\\\\)\\\\s*\\\\{\",\n                returnBegin: true,\n                label: \"func.def\",\n                contains: [\n                    PARAMS,\n                    hljs.inherit(hljs.TITLE_MODE, { begin: IDENT_RE, scope: \"title.function\" })\n                ]\n            },\n            PROPERTY_ACCESS,\n            {\n                match: [/\\binit(?=\\s*\\()/],\n                scope: { 1: \"title.function\" },\n                contains: [PARAMS]\n            },\n            FUNCTION_CALL,\n            UPPER_CASE_CONSTANT,\n            CLASS_OR_EXTENDS,\n            {\n                match: /\\$[(.]/ // relevance booster for a pattern common to JS libs: `$(something)` and `$.something`\n            }\n        ]\n    };\n};\nexport default lox;"]}