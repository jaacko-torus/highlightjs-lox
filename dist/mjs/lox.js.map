{"version":3,"sources":["lox.ts"],"names":[],"mappings":"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","file":"lox.js","sourcesContent":["/**\n * @name Lox\n * @param {LanguageFn} hljs\n * @website http://craftinginterpreters.com/\n * @license MIT\n */\n\nimport type { HLJSRegex } from \"../types\";\nimport type { HLJSApi, Language, LanguageFn, Mode } from \"highlight.js\";\nimport hljs from \"highlight.js\";\n\nconsole.log(hljs)\n\nconst regex = (hljs as HLJSApi & HLJSRegex).regex\n\nconst IDENT_RE = \"[A-Za-z][0-9A-Za-z]*\"\n\nconst LANGUAGE_KEYWORDS = [\n\t\"class\",\n\t\"else\",\n\t\"for\",\n\t\"function\",\n\t\"if\",\n\t\"print\",\n\t\"return\",\n\t\"var\",\n\t\"while\",\n]\n\nconst LITERALS = [\n\t\"false\",\n\t\"nil\",\n\t\"true\",\n]\n\nconst BUILT_IN_VARIABLES = [\n\t\"super\",\n\t\"this\",\n]\n\nconst KEYWORDS = {\n\t$pattern: IDENT_RE,\n\tkeyword: LANGUAGE_KEYWORDS,\n\tliteral: LITERALS,\n\t\"variable.language\": BUILT_IN_VARIABLES\n};\n\nconst NUMBER: Mode = {\n\tscope: \"number\",\n\tvariants: [\n\t\t{ begin: \"[\\\\d]+\" },\n\t\t{ begin: \"\\\\d+(\\.\\\\d+)?\" },\n\t],\n\trelevance: 0\n};\n\nconst PARAMS_CONTAINS = [\n\thljs.C_LINE_COMMENT_MODE,\n\t// eat recursive parens in sub expressions\n\t{\n\t\tbegin: /\\(/,\n\t\tend: /\\)/,\n\t\tkeywords: KEYWORDS,\n\t\tcontains: [\"self\", hljs.C_LINE_COMMENT_MODE]\n\t} as Mode\n];\n\nconst PARAMS: Mode = {\n\tscope: \"params\",\n\tbegin: /\\(/,\n\tend: /\\)/,\n\texcludeBegin: true,\n\texcludeEnd: true,\n\tkeywords: KEYWORDS,\n\tcontains: PARAMS_CONTAINS\n};\n\nconst CLASS_OR_EXTENDS: Mode = {\n\tvariants: [\n\t\t// class Car < Vehicle\n\t\t{\n\t\t\tmatch: [\n\t\t\t\t/class/,\n\t\t\t\t/\\s+/,\n\t\t\t\tIDENT_RE,\n\t\t\t\t/\\s+/,\n\t\t\t\t/</,\n\t\t\t\t/\\s+/,\n\t\t\t],\n\t\t\tscope: {\n\t\t\t\t1: \"keyword\",\n\t\t\t\t3: \"title.class\",\n\t\t\t\t5: \"keyword\",\n\t\t\t\t7: \"title.class.inherited\"\n\t\t\t}\n\t\t},\n\t\t// class Car\n\t\t{\n\t\t\tmatch: [\n\t\t\t\t/class/,\n\t\t\t\t/\\s+/,\n\t\t\t\tIDENT_RE\n\t\t\t],\n\t\t\tscope: {\n\t\t\t\t1: \"keyword\",\n\t\t\t\t3: \"title.class\"\n\t\t\t}\n\t\t},\n\t]\n};\n\nconst FUNCTION_DEFINITION: Mode = {\n\tvariants: [\n\t\t{\n\t\t\tmatch: [\n\t\t\t\t/function/,\n\t\t\t\t/\\s+/,\n\t\t\t\tIDENT_RE,\n\t\t\t\t/(?=\\s*\\()/\n\t\t\t]\n\t\t},\n\t],\n\tscope: {\n\t\t1: \"keyword\",\n\t\t3: \"title.function\"\n\t},\n\tlabel: \"func.def\",\n\tcontains: [PARAMS],\n\tillegal: /%/\n};\n\nconst UPPER_CASE_CONSTANT: Mode = {\n\trelevance: 0,\n\tmatch: /\\b[A-Z][A-Z0-9]+\\b/,\n\tscope: \"variable.constant\"\n};\n\nfunction noneOf(list: string[]) {\n\treturn regex.concat(\"(?!\", list.join(\"|\"), \")\");\n}\n\nconst FUNCTION_CALL: Mode = {\n\tmatch: regex.concat(\n\t\t/\\b/,\n\t\tnoneOf([\"super\"]),\n\t\tIDENT_RE, regex.lookahead(/\\(/)),\n\tscope: \"title.function\",\n\trelevance: 0\n};\n\nconst PROPERTY_ACCESS: Mode = {\n\tbegin: regex.concat(/\\./, regex.lookahead(\n\t\tregex.concat(IDENT_RE, /(?![0-9A-Za-z(])/)\n\t)),\n\tend: IDENT_RE,\n\texcludeBegin: true,\n\tscope: \"property\",\n\trelevance: 0\n};\n\n// HLJSApi\n\n/**\n * @name Lox\n * @param {HLJSApi} hljs\n * @website http://craftinginterpreters.com/\n */\nconst lox: LanguageFn = (hljs: HLJSApi) => {\n\treturn {\n\t\tname: \"Lox\",\n\t\taliases: [\"lox\"],\n\t\tkeywords: KEYWORDS,\n\t\tillegal: /#(?![$_A-z])/,\n\t\tcontains: [\n\t\t\thljs.QUOTE_STRING_MODE,\n\t\t\thljs.C_LINE_COMMENT_MODE,\n\t\t\tNUMBER,\n\t\t\t{ // \"value\" container\n\t\t\t\tbegin: \"(\" + hljs.RE_STARTERS_RE + \"|\\\\b(return)\\\\b)\\\\s*\",\n\t\t\t\tkeywords: \"return\",\n\t\t\t\trelevance: 0,\n\t\t\t\tcontains: [\n\t\t\t\t\thljs.C_LINE_COMMENT_MODE,\n\t\t\t\t\thljs.REGEXP_MODE,\n\t\t\t\t\t{ // could be a comma delimited list of params to a function call\n\t\t\t\t\t\tbegin: /,/,\n\t\t\t\t\t\trelevance: 0\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tmatch: /\\s+/,\n\t\t\t\t\t\trelevance: 0\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t\tFUNCTION_DEFINITION,\n\t\t\t{\n\t\t\t\t// prevent this from getting swallowed up by function since they appear \"function like\"\n\t\t\t\tbeginKeywords: \"while if for\"\n\t\t\t},\n\t\t\t{\n\t\t\t\t// we have to count the parens to make sure we actually have the correct\n\t\t\t\t// bounding ( ).  There could be any number of sub-expressions inside\n\t\t\t\t// also surrounded by parens.\n\t\t\t\tbegin: \"\\\\b(?!function)\" + hljs.UNDERSCORE_IDENT_RE +\n\t\t\t\t\t\"\\\\(\" + // first parens\n\t\t\t\t\t\"[^()]*(\\\\(\" +\n\t\t\t\t\t\"[^()]*(\\\\(\" +\n\t\t\t\t\t\"[^()]*\" +\n\t\t\t\t\t\"\\\\)[^()]*)*\" +\n\t\t\t\t\t\"\\\\)[^()]*)*\" +\n\t\t\t\t\t\"\\\\)\\\\s*\\\\{\", // end parens\n\t\t\t\treturnBegin: true,\n\t\t\t\tlabel: \"func.def\",\n\t\t\t\tcontains: [\n\t\t\t\t\tPARAMS,\n\t\t\t\t\thljs.inherit(hljs.TITLE_MODE, { begin: IDENT_RE, scope: \"title.function\" })\n\t\t\t\t]\n\t\t\t},\n\t\t\tPROPERTY_ACCESS,\n\t\t\t{\n\t\t\t\tmatch: [/\\binit(?=\\s*\\()/],\n\t\t\t\tscope: { 1: \"title.function\" },\n\t\t\t\tcontains: [PARAMS]\n\t\t\t},\n\t\t\tFUNCTION_CALL,\n\t\t\tUPPER_CASE_CONSTANT,\n\t\t\tCLASS_OR_EXTENDS,\n\t\t\t{\n\t\t\t\tmatch: /\\$[(.]/ // relevance booster for a pattern common to JS libs: `$(something)` and `$.something`\n\t\t\t}\n\t\t]\n\t} as Language;\n}\n\nexport default lox;"]}